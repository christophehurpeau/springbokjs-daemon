{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"src/index.js","sourcesContent":["var childProcess = require('child_process');\nvar util = require('util');\nvar ConsoleLogger = require('springbokjs-logger/console');\nvar EventEmitter = require('events').EventEmitter;\n\nclass SpringbokDaemon extends EventEmitter {\n    constructor(command, args) {\n        super();\n        this.command = command;\n        this.args = args;\n        this.process = null;\n        this.restarting = false;\n        this.logger = new ConsoleLogger();\n        this.logger.setPrefix('springbokjs-daemon: ', this.logger.blue.bold);\n        this.logger.debug(command + (args && (' ' + args.join(' '))));\n    }\n\n    start() {\n        this.logger.debug('Starting');\n        this.stop();\n\n        this.process = childProcess.spawn(this.command, this.args);\n        this.process.stdout.addListener('data', function(data) {\n            process.stdout.write(data);\n            this.emit('stdout', data);\n        }.bind(this));\n        this.process.stderr.addListener('data', function(data) {\n            process.stderr.write(data);\n            this.emit('stderr', data);\n        }.bind(this));\n        this.process.addListener('exit', function(code) {\n            this.logger.debug('exited (status=' + code + ')');\n            this.process = null;\n            if (this.restarting) {\n                this.start();\n            }\n        }.bind(this));\n    }\n\n    stop() {\n        this.restarting = false;\n        if (this.process) {\n            this.process.kill();\n        }\n    }\n\n    restart() {\n        if (this.process) {\n            this.logger.debug('Stopping for restart');\n            this.restarting = true;\n            this.process.kill();\n        } else {\n            this.start();\n        }\n    }\n}\n\nvar createDaemon = function(command, args) {\n    return new SpringbokDaemon(command, args);\n};\n\nexport default createDaemon;\n\ncreateDaemon.node = function(args) {\n    return createDaemon('node', args);\n};\n"]}